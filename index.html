<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pranayama Practice Guide</title>
    <meta name="description" content="A guided pranayama practice tool based on Liber E.">
    <meta name="keywords" content="pranayama, breathing exercise, nadi shodhana, alternate nostril breathing, meditation, Aleister Crowley, Liber E, Thelema, Liber IX">
    <meta name="application-name" content="Pranayama Practice">
    <meta name="apple-mobile-web-app-title" content="Pranayama Practice">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#101010">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet" media="none" onload="if(media!='all') media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet"></noscript>
    <style>
        /* Root variables for theming */
        :root {
            --background-color: #101010;
            --text-color: #f8f0e3;
            --ida-blue: #004dab;
            --pingala-red: #ff2a00;
            --sushumna-yellow: #fee74d;
            --sushumna-green: #00a550;
            --neutral-color: #333;
            --font-family-base: 'Space Mono', monospace;
        }

        /* Dark mode theme */
        body.dark-mode {
            --background-color: #101010;
            --text-color: #f8f0e3;
            --neutral-color: #333;
        }

        /* Light mode theme */
        body.light-mode {
            --background-color: #f8f0e3;
            --text-color: #101010;
            --neutral-color: #f8f0e3;
        }

        /* General body styles */
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: var(--font-family-base);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1;
            transition: background-color 0.3s ease;
        }

        /* Heading and text styles */
        h1, h2, h3, p, button, select, .timer, .instruction, .stats {
            font-family: var(--font-family-base);
        }

        /* Main container */
        .container {
            text-align: center;
            width: 90%;
            max-width: 800px;
            margin-bottom: 5px;
            position: relative;
            transition: margin 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        body.fullscreen-mode .container {
            margin-bottom: 0;
        }

        h1 {
            margin-bottom: 10px;
        }

        /* Level selection dropdown */
        .level-select {
            margin-bottom: 10px;
        }

        select {
            padding: 8px;
            font-size: 14px;
            background-color: var(--neutral-color);
            color: var(--text-color);
            border: 1px solid #666;
            border-radius: 5px;
            appearance: none;
            -webkit-appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23F8F0E3" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
            background-repeat: no-repeat;
            background-position-x: 100%;
            background-position-y: 5px;
            transition: border-color 0.3s ease;
        }

        body.light-mode select {
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23101010" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
        }

        body.light-mode select {
            border-color: #888;
        }

        /* Practice visualization area */
        .practice-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin: 40px 0;
            height: 270px;
            transition: all 0.5s ease;
        }

        body.fullscreen-mode .practice-area {
            margin: 0 0 20px 0;
            position: static;
            transform: none;
        }

        /* Nostril circles */
        .nostril-circle {
            aspect-ratio: 1 / 1;
            width: 165px;
            max-width: 30vw;
            border-radius: 50%;
            transition: transform 1s linear, opacity 1s linear, width 0.5s ease;
        }

        body.fullscreen-mode .nostril-circle {
            width: 200px;
        }

        @media (max-width: 768px) {
            .nostril-circle {
                width: 165px;
            }
        }

        @media (max-width: 480px) {

            body.fullscreen-mode     .practice-area {
            margin: 0 0 0px 0;
            position: static;
            transform: none;
            margin-bottom: 30px;
        }

        body.fullscreen-mode  .nostril-circle {
                max-width: 140px;
            }

            .breath-bar {
            height: 150px;
            max-width: 45px;
            }

            select {
                width: calc(100% - 20px);
            }

            h1 {
                font-size: 28px;
            }

            .instruction {
                font-size: 8px;
            }

            .stats {
                font-size: 8px;
            }


        }

        .left-nostril {
            background-color: var(--ida-blue);
        }

        .right-nostril {
            background-color: var(--pingala-red);
        }

        /* Breath indicator bar */
        .breath-bar {
            width: 35px;
            height: 250px;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            transition: width 0.5s ease;
        }

        .breath-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--sushumna-yellow);
            height: 100%;
            transition: height 1s linear, background-color 0.3s ease;
        }

        .breath-fill.hold {
            background-color: var(--sushumna-green);
        }

        /* Instruction text */
        .instruction {
            font-size: 17px;
        }

        /* Timer display */
        .timer {
            font-size: 55px;
            margin-bottom: 10px;
            transition: font-size 0.5s ease, margin-bottom 0.3s ease, top 0.5s ease, left 0.5s ease, transform 0.5s ease;
            position: relative;
        }

        body.fullscreen-mode .timer {
            font-size: 70px;
            position: static;
            transform: none;
            margin-top: 15px;
        }

        /* Control buttons */
        .controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        /* Extra control buttons */
        .extra-controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .control-button {
            padding: 8px 16px;
            font-size: 13px;
            background-color: var(--neutral-color);
            color: var(--text-color);
            border: 1px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: border-color 0.3s ease;
        }

        body.light-mode .control-button {
            border-color: var(--text-color);
        }

        .control-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Practice statistics */
        .stats {
            font-size: 14px;
            transition: opacity 0.5s ease, top 0.5s ease, left 0.5s ease, transform 0.5s ease;
            text-align: center;
            max-width: 600px;
            display: flex;
        }

        body.fullscreen-mode .stats {
            position: static;
            transform: none;
            opacity: 1;
        }

        .stats p {
            margin-bottom: 15px;
        }

        /* Sound controls */
        .sound-controls {
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sound-controls p {
            margin: 0;
            font-size: 13px;
        }

        .sound-controls button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.3em;
            color: var(--text-color);
            padding: 0;
        }

        #volumeSlider {
            width: 80px;
            height: 6px;
            background: #666;
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        #volumeSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--sushumna-yellow);
            border-radius: 50%;
            cursor: pointer;
        }

        #volumeSlider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--sushumna-yellow);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Sound recommendation text */
        .sound-recommendation {
            margin-bottom: 25px;
            font-size: 13px;
        }

        /* Collapsible sections */
        .collapsible-section {
            text-align: left;
            max-width: 800px;
            margin-top: 20px;
            margin-bottom: 40px;
        }

        .collapsible-section ol{
            line-height: 1.5;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 5px;
            border-bottom: 1px solid #555;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .collapsible-header h3 {
            margin: 0;
        }

        .collapsible-header .toggle-icon {
            font-size: 1em;
            transition: transform 0.3s ease-in-out;
        }

        .collapsible-header .toggle-icon.open {
            transform: rotate(90deg);
        }

        .collapsible-content {
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }

        .collapsible-content.collapsed {
            max-height: 0;
        }

        .collapsible-section p {
            line-height: 1.5;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
        }

        .collapsible-section a {
          font-weight: bold;
          color: var(--text-color);
          text-decoration: underline;
        }

        /* Custom breath settings modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: var(--neutral-color);
            color: var(--text-color);
            margin: 15% auto;
            padding: 15px;
            border: 1px solid #888;
            width: 80%;
            max-width: 270px;
            border-radius: 5px;
            text-align: left;
        }

        .modal-content label {
            display: block;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }

        .modal-content input[type="number"] {
            width: calc(100% - 16px);
            padding: 6px;
            margin-bottom: 10px;
            border: 1px solid #666;
            border-radius: 4px;
            background-color: var(--background-color);
            color: var(--text-color);
            font-size: 0.9rem;
        }

        .modal-content button {
            margin-top: 15px;
            padding: 8px 16px;
            font-size: 13px;
            background-color: var(--neutral-color);
            color: var(--text-color);
            border: 1px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: border-color 0.3s ease;
            border-color: var(--text-color);
        }

        /* Side panel for customizations */
        .side-panel {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            height: 100%;
            width: 250px;
            background-color: var(--neutral-color);
            color: var(--text-color);
            padding: 15px;
            box-shadow: -2px 0 5px rgba(0,0,0,0.5);
            overflow-y: auto;
            z-index: 1000;
            text-align: left;
            font-size: 0.9rem;
        }

        .side-panel h2, .side-panel h3 {
            margin-top: 60px;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .side-panel h3 {
            font-size: 1rem;
            margin-top: 15px;
        }

        .side-panel label {
            display: block;
            margin-bottom: 3px;
        }

        .side-panel input[type="color"] {
            width: 60%;
            margin-bottom: 10px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            height: 25px;
            border: none;
            cursor: pointer;
            background: none;
        }

        .side-panel input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        .side-panel input[type="color"]::-webkit-color-swatch {
            border: 1px solid #aaa;
            border-radius: 3px;
        }

        .side-panel button {
            margin-top: 15px;
            padding: 8px 16px;
            font-size: 13px;
            background-color: var(--neutral-color);
            color: var(--text-color);
            border: 1px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: border-color 0.3s ease;
            border-color: var(--text-color);
        }

        /* Fullscreen mode adjustments */
        body.fullscreen-mode .container {
            margin-bottom: 0;
            margin-top: 10px;
        }

        body.fullscreen-mode h1, body.fullscreen-mode .level-select {
            display: none;
        }

        body.fullscreen-mode .practice-area {
            margin-top: 60px;
            height: auto;
        }

        body.fullscreen-mode .nostril-circle {
            width: 300px;
        }

        body.fullscreen-mode .breath-bar {
            height: 350px;
            width: 65px;
        }

        body.fullscreen-mode .timer {
            font-size: 60px;
            margin-top: 20px;
        }

        body.fullscreen-mode .stats {
            opacity: 1;
        }
    </style>
</head>
<body class="dark-mode">
    <!-- Main container for the practice tool -->
    <div class="container">
        <h1>Pranayama Practice</h1>
        <!-- Level selection dropdown -->
        <div class="level-select">
            <label for="level" style="display: none;">Select Practice Level</label>
            <select id="level">
                <option value="1">Level 1 (Out: 20s, In: 10s)</option>
                <option value="2">Level 2 (Out: 30s, In: 15s)</option>
                <option value="3">Level 3 (Out: 15s, In: 15s, Hold: 15s)</option>
                <option value="4">Level 4 (Out: 40s, In: 20s)</option>
                <option value="5">Level 5 (Out: 20s, In: 10s, Hold: 30s)</option>
                <option value="custom">Custom</option>
            </select>
        </div>
        <!-- Visualization of the breathing practice -->
        <section class="practice-area" aria-live="polite">
            <div id="left-nostril" class="nostril-circle left-nostril" aria-label="Left nostril"></div>
            <div id="breath-bar" class="breath-bar" aria-label="Breath indicator"> <div id="breath-fill" class="breath-fill"></div>
            </div>
            <div id="right-nostril" class="nostril-circle right-nostril" aria-label="Right nostril"></div>
        </section>
        <!-- Timer display -->
        <div id="timer" class="timer">00:00</div>
        <!-- Instruction text -->
        <div id="instruction" class="instruction">Select a level, breathe in and press Start to begin</div>
        <!-- Practice statistics -->
        <div class="stats">
            <p>Total Practice Time: <span id="totalTime">00:00:00</span> / Cycles Completed: <span id="cyclesCompleted">0</span></p>
        </div>
        <!-- Main control buttons -->
        <section class="controls">
            <button id="startBtn" class="control-button" aria-label="Start practice">
                Start
            </button>
            <button id="pauseBtn" class="control-button" aria-label="Pause practice" disabled>
                Pause
            </button>
            <button id="resetBtn" class="control-button" aria-label="Reset practice" disabled>
                Reset
            </button>
        </section>
        <!-- Extra control buttons -->
        <section class="extra-controls">
            <button id="darkModeToggle" class="control-button">Light Mode</button>
            <button id="fullscreenBtn" class="control-button">Expand View</button>
            <button id="customizeBtn" class="control-button">Customize</button>
        </section>
        <!-- Sound control options -->
        <section class="sound-controls">
            <p>Sound Cues</p>
            <button id="soundBtn" aria-label="Toggle sound cues">
                <i class="fas fa-volume-mute"></i>
            </button>
            <div class="slider-container">
                <input type="range" id="volumeSlider" min="0" max="0.18" step="0.01" value="0.02" aria-label="Adjust sound volume">
            </div>
        </section>
        <!-- Sound recommendation text -->
        <div class="sound-recommendation">
            <p>(Headphones and low volumes recommended)</p>
        </div>
    </div>

    <!-- Customization side panel -->
    <div id="customizationPanel" class="side-panel">
        <h2>Customization</h2>
        <h3>Colors</h3>
        <label for="rightNostrilColor">Right Nostril:</label>
        <input type="color" id="rightNostrilColor" value="#ff2a00">
        <input type="text" id="rightNostrilHex" placeholder="#RRGGBB" size="7"><br>

        <label for="leftNostrilColor">Left Nostril:</label>
        <input type="color" id="leftNostrilColor" value="#004dab">
        <input type="text" id="leftNostrilHex" placeholder="#RRGGBB" size="7"><br>

        <label for="breathBarFillColor">Breath Fill:</label>
        <input type="color" id="breathBarFillColor" value="#fee74d">
        <input type="text" id="breathBarFillHex" placeholder="#RRGGBB" size="7"><br>

        <label for="breathBarHoldColor">Breath Hold:</label>
        <input type="color" id="breathBarHoldColor" value="#00a550">
        <input type="text" id="breathBarHoldHex" placeholder="#RRGGBB" size="7"><br>

        <button id="saveChanges">Save Changes</button>
        <button id="resetChanges">Reset to Default</button>
    </div>

    <!-- Context collapsible section -->
    <section class="collapsible-section">
        <div class="collapsible-header">
            <h3>Context:</h3>
            <i class="fas fa-chevron-down toggle-icon open"></i>
        </div>
        <div class="collapsible-content">
            <p>This practice is based on the pranayama exercise described in Aleister Crowley's <a href="https://keepsilence.org/the-equinox/1.1/liber-exercitiorum_low.pdf" target="_blank">Liber E. vel Exercitiorum, sub figura IX</a>. While the text uses the general term "pranayama", the described technique closely aligns with Nadi Shodhana Pranayama, also known as alternate nostril breathing.</p>
            <p>I would describe the practice as: Sitting in your Asana, a stable and comfortable position, Begin by closing your right nostril with your thumb, exhaling slowly through your left nostril for 20 seconds, then inhaling through the same nostril for 10 seconds. Alternate nostrils and repeat the process. Start with a duration that feels comfortable to you, and gradually work toward an hour.
            Once you can practice level one comfortably for a full hour, move to the next level. Only advance a level once you have maintained comfort and control in the current level for at least an hour.</p>
            <p>The practice area visualizes your breathing. The colored circles represent your nostrils, blue for the left and red for the right. The central bar fills with yellow during inhalation and empties during exhalation. When holding your breath, the bar turns green.</p>
        </div>
    </section>

    <!-- Recommendations and precautions collapsible section -->
    <section class="collapsible-section">
        <div class="collapsible-header">
            <h3>Recommendations and Precautions for a Safe Practice:</h3>
            <i class="fas fa-chevron-down toggle-icon open"></i>
        </div>
        <div class="collapsible-content">
            <p>If you're new to alternate nostril breathing, begin with just 5–10 minutes per session. Gradually increase the time as your comfort and confidence grow.</p>
            <p></p>
            <p>Please approach this practice with ease and control. Think of it as guiding your breath, not forcing it. Strive for deep, full, and regular breathing rather than forcing longer durations or perfect timings too quickly.</p>
            <p>Practice in a quiet, comfortable space, seated with your spine straight. It’s best to practice on an empty stomach to avoid discomfort during prolonged breathing exercises.</p>
            <p>Listen to your body. If you experience discomfort, dizziness, or shortness of breath, stop the practice and rest.</p>
            <p>If done improperly, especially rushed or overly intense pranayama can cause hyperventilation and may overactivate the sympathetic nervous system, leading to stress on the body. Avoid prolonged or rapid breathing without guidance.</p>
            <p>If you are pregnant or have health conditions like high blood pressure, asthma, epilepsy, or heart problems, consult a healthcare provider before practicing.</p>
            <h4>This guide is not a substitute for professional medical advice or supervision.</h4>
            <h3 class="sources-links">Sources:</h3>
            <p><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC3415184/#sec1-5" target="_blank">Health Impacts of Yoga and Pranayama</a></p>
            <p><a href="https://philpapers.org/archive/RAVPOL.pdf" target="_blank">Pranayama and its Effects</a></p>
            <p><a href="https://www.researchgate.net/publication/273292173_EFFECTS_OF_PRACTICE_OF_PRANAYAMA_ON_CONTROL_OF_LIFE_STYLE_DISORDERS" target="_blank">Effects of Pranayama on Lifestyle Disorders</a></p>
            <p><a href="https://www.semanticscholar.org/paper/Effect-of-Nadi-Shodhana-Pranayama-on-Respiratory-in-Sivapriya-Subamalani/c925be82cbfcc3b590aa0de9d82880a716631595" target="_blank">Effect of Nadi Shodhana Pranayama on Respiratory Parameters in School Students</a></p>
            <p><a href="https://www.semanticscholar.org/paper/Effectiveness-of-Nadi-Shodhana-Pranayama-on-Test-of-Mary-Sibi/f81791e0b6b4ae656c20de3b7fb4821671b12ebc" target="_blank">Effectiveness of Nadi Shodhana Pranayama on Test Anxiety among Nursing Students</a></p>
        </div>
    </section>

    <!-- Excerpt from Liber E. collapsible section -->
    <section class="collapsible-section">
        <div class="collapsible-header">
            <h3>Excerpt from LIBER E. VEL EXERCITIORVM SVB FIGVRA IX:</h3>
            <i class="fas fa-chevron-down toggle-icon open"></i>
        </div>
        <div class="collapsible-content">
            <h3>Pranayama—Regularisation of the Breathing</h3>
            <ol>
                <li>At rest. in one of your positions, close the right nostril with the thumb of the right hand and breathe out slowly and completely through the left nostril, while your watch marks 20 seconds. Breathe in through the same nostril for 10 seconds. Changing hands, repeat with the other nostril. Let this be continuous for one hour.</li>
                <li>When this is quite easy to you, increase the periods to 30 and 15 seconds.</li>
                <li>When this is quite easy to you, but not before, breathe out for 15 seconds, in for 15 seconds, and hold the breath for 15 seconds.</li>
                <li>When you can do this with perfect ease and comfort for a whole hour, practise breathing out for 40, in for 20 seconds.</li>
                <li>This being attained, practise breathing out for 20, in for 10, holding the breath for 30 seconds. When this has become perfectly easy to you, you may be admitted for examination, and should you pass, you will be instructed in more complex and difficult practices.</li>
                <li>You will find that the presence of food in the stomach, even in small quantities, makes the practices very difficult.</li>
                <li>Be very careful never to overstrain your powers; especially never get so short of breath that you are compelled to breathe out jerkily or rapidly.</li>
                <li>Strive after depth, fulness, and regularity of breathing.                <li>Various remarkable phenomena will very probably occur during these practices. They must be carefully analysed and recorded.</li>
            </ol>
            <h4>From: <a href="https://keepsilence.org/the-equinox/1.1/liber-exercitiorum_low.pdf" target="_blank">https://keepsilence.org/the-equinox/1.1/liber-exercitiorum_low.pdf</a></h4>
        </div>
    </section>

    <!-- About collapsible section -->
    <section class="collapsible-section">
        <div class="collapsible-header">
            <h3>About:</h3>
            <i class="fas fa-chevron-down toggle-icon open"></i>
        </div>
        <div class="collapsible-content">
            <p>I started to develop this simple tool to help my own pranayama practice and also to practice web design/dev at the same time, following this very specific iteration of the exercise. After reaching a point where it was functional and testing it over extended periods of time, I realized its potential and that it could definitely be useful for other practitioners out there, so on a whim I decided to publish it and to make it open source, free to the public, hoping it can enhance and motivate your practice in some way or another, like it did with mine.</p>
            <p>You can find the source code for this project on <a href="https://github.com/Gron28/Pranayama-Test">GitHub</a>.</p>
            <p>For inquiries or feedback, feel free to <a href="https://mail.google.com/mail/?view=cm&fs=1&to=villadafelipe28@gmail.com" target="_blank" >contact me</a>.</p>
            <p>If you find this guide helpful and wish to support, you can do so via <a href="https://paypal.me/Gron28">PayPal</a>.</p>
            <p>To learn more about me you can check out my <a href="https://gron28.github.io/Portfolio-Website" target="_blank" >website/portfolio</a> (Im still working on it, it is mainly UX/UI design right now, but it is slowly evolving toward my vision of it).</p>
        </div>
    </section>

    <!-- Further reading recommendations collapsible section -->
    <section class="collapsible-section">
        <div class="collapsible-header">
            <h3>Further Reading (Personal Recommendations)</h3>
            <i class="fas fa-chevron-down toggle-icon open"></i>
        </div>
        <div class="collapsible-content">
            <p>Liber ABA: Book 4, Parts I & II, by A. C.</p>
            <p>Magick Without Tears, by A. C.</p>
            <p>8 Lectures on Yoga, by A. C.</p>
            <p>The Magick of Aleister Crowley, by Lon Milo DuQuette</p>
            <p>Autobiography of a Yogi, by Paramahansa Yogananda</p>
            <p>Tantra Illuminated, by Christopher D. Wallis</p>
        </div>
    </section>

    <!-- Custom breath settings modal -->
    <div id="customModal" class="modal">
        <div class="modal-content">
            <span class="close-button"></span>
            <h2>Custom Breath Settings</h2>
            <label for="customIn">Inhale (seconds):</label>
            <input type="number" id="customIn" min="1">
            <label for="customOut">Exhale (seconds):</label>
            <input type="number" id="customOut" min="1">
            <label for="customHold">Hold (seconds):</label>
            <input type="number" id="customHold" min="0">
            <button type="button" class="save">Save</button>
            <button type="button" class="cancel">Cancel</button>
        </div>
    </div>

    <script>
        // Configuration for practice levels
        const levelConfigs = {
            1: { out: 20, in: 10, hold: 0 },
            2: { out: 30, in: 15, hold: 0 },
            3: { out: 15, in: 15, hold: 15 },
            4: { out: 40, in: 20, hold: 0 },
            5: { out: 20, in: 10, hold: 30 }
        };

        // Global variables for timer and practice state
        let timer;
        let currentPhase = 'ready';
        let timeLeft = 0;
        let totalSeconds = 0;
        let cycles = 0;
        let currentNostril = 'left';
        let isPaused = false;
        let globalVolume = 0.02;
        let isFullscreen = false;
        let isDarkMode = true;
        let customConfig = {};

        // DOM elements
        const elements = {
            leftNostril: document.getElementById('left-nostril'),
            rightNostril: document.getElementById('right-nostril'),
            breathFill: document.getElementById('breath-fill'),
            breathBar: document.getElementById('breath-bar'),
            instruction: document.getElementById('instruction'),
            timer: document.getElementById('timer'),
            totalTime: document.getElementById('totalTime'),
            cyclesCompleted: document.getElementById('cyclesCompleted'),
            startBtn: document.getElementById('startBtn'),
            pauseBtn: document.getElementById('pauseBtn'),
            resetBtn: document.getElementById('resetBtn'),
            levelSelect: document.getElementById('level'),
            customModal: document.getElementById('customModal'),
            customIn: document.getElementById('customIn'),
            customOut: document.getElementById('customOut'),
            customHold: document.getElementById('customHold'),
            soundBtn: document.getElementById('soundBtn'),
            volumeSlider: document.getElementById('volumeSlider'),
            customizeBtn: document.getElementById('customizeBtn'),
            customizationPanel: document.getElementById('customizationPanel'),
            fullscreenBtn: document.getElementById('fullscreenBtn'),
            darkModeToggle: document.getElementById('darkModeToggle'),
            
        };
        // Audio context and tick sound state
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isTickPlaying = false;
        let soundEnabled = false;

        // Function to create a sound with a specific frequency and duration
        function createSound(frequency, duration) {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(frequency, audioCtx.currentTime);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            gainNode.gain.setValueAtTime(globalVolume, audioCtx.currentTime);

            const stopTime = audioCtx.currentTime + duration;
            gainNode.gain.linearRampToValueAtTime(0, stopTime);

            oscillator.start();
            oscillator.stop(stopTime);
        }

        // Function to play a tick sound
        function playTickSound() {
            if (soundEnabled && !isTickPlaying) {
                isTickPlaying = true;
                createSound(185, 0.15);
                setTimeout(() => {
                    isTickPlaying = false;
                }, 150);
            }
        }

        // Function to play a sound indicating phase transition
        function playPhaseTransitionSound(phase) {
            if (soundEnabled) {
                let frequency = 220;
                if (phase === 'in') frequency = 200;
                else if (phase === 'out') frequency = 200;
                else if (phase === 'hold') frequency = 280;

                const delay = isTickPlaying ? 150 : 0;
                setTimeout(() => {
                    createSound(frequency, 0.75);
                }, delay);
            }
        }

        // Function to pause CSS animations
        function pauseAnimation(element) {
            element.classList.add("paused");
        }

        // Function to resume CSS animations
        function resumeAnimation(element) {
            element.classList.remove("paused");
        }

        // Function to update breath visualization based on the current phase
        function updateBreathVisualization(phase, nostril, timeLeft, duration) {
            const activeNostril = (nostril === 'left') ? elements.leftNostril : elements.rightNostril;
            const inactiveNostril = (nostril === 'left') ? elements.rightNostril : elements.leftNostril;

            if (phase === 'ready' || phase === 'hold') {
                inactiveNostril.style.opacity = 1;
                activeNostril.style.opacity = 1;
            } else if (phase === 'out' || phase === 'in') {
                inactiveNostril.style.opacity = 0;
                activeNostril.style.opacity = 1;
            }

            if (phase === 'ready') {
                elements.breathFill.style.height = '100%';
                elements.breathFill.classList.remove('hold');
                activeNostril.style.transform = 'scale(1)';
                inactiveNostril.style.transform = 'scale(1)';
            } else if (phase === 'out') {
                const scale = 1 - (1 - 0.2) * ((duration - timeLeft) / duration);
                activeNostril.style.transform = `scale(${scale})`;
                inactiveNostril.style.transform = 'scale(1)';
                elements.breathFill.style.height = `${100 - ((duration - timeLeft) / duration) * 100}%`;
                elements.breathFill.classList.remove('hold');
            } else if (phase === 'in') {
                const scale = 0.2 + (1 - 0.2) * ((duration - timeLeft) / duration);
                activeNostril.style.transform = `scale(${scale})`;
                inactiveNostril.style.transform = 'scale(1)';
                elements.breathFill.style.height = `${((duration - timeLeft) / duration) * 100}%`;
                elements.breathFill.classList.remove('hold');
            } else if (phase === 'hold') {
                elements.breathFill.classList.add('hold');
                elements.breathFill.style.height = '100%';
                activeNostril.style.transform = 'scale(1)';
                inactiveNostril.style.transform = 'scale(1)';
            }

            elements.instruction.textContent =
                phase === 'ready' ? 'Select a level, breathe in and press Start to begin' :
                phase === 'out' ? `Breathe out through ${nostril} nostril` :
                phase === 'in' ? `Breathe in through ${nostril} nostril` :
                'Hold breath';

            elements.breathFill.setAttribute("aria-label", `Breath indicator - ${phase}: ${timeLeft} seconds remaining`);
        }

        // Function to update accessibility attributes for the breath bar
        function updateBreathBarAccessibility(phase, timeLeft, duration) {
            const percentage = (duration - timeLeft) / duration * 100;
            elements.breathFill.setAttribute("aria-valuenow", percentage.toFixed(0));
            elements.breathFill.setAttribute("aria-valuemin", 0);
            elements.breathFill.setAttribute("aria-valuemax", 100);
            elements.breathBar.setAttribute("role", "progressbar");
        }

        // Function to update the timer and breath visualization
        function updateTimer() {
            if (!isPaused && currentPhase !== 'ready') {
                timeLeft--;
                totalSeconds++;
                elements.totalTime.textContent = formatTime(totalSeconds, true);
                elements.timer.textContent = formatTime(timeLeft);

                const selectedLevel = elements.levelSelect.value;
                const config = levelConfigs[selectedLevel] || customConfig;
                const duration = config[currentPhase === 'out' ? 'out' : currentPhase === 'in' ? 'in' : 'hold'];

                updateBreathVisualization(currentPhase, currentNostril, timeLeft, duration);
                playTickSound();

                if (timeLeft <= 0) {
                    nextPhase();
                }
            }
        }

        // Function to advance to the next phase of breathing
        function nextPhase() {
            const selectedLevel = elements.levelSelect.value;
            const config = levelConfigs[selectedLevel] || customConfig;

            if (currentPhase === 'out') {
                currentPhase = 'in';
                timeLeft = config.in;
                playPhaseTransitionSound('in');
            } else if (currentPhase === 'in') {
                if (config.hold > 0) {
                    currentPhase = 'hold';
                    timeLeft = config.hold;
                    playPhaseTransitionSound('hold');
                } else {
                    currentPhase = 'out';
                    currentNostril = currentNostril === 'left' ? 'right' : 'left';
                    timeLeft = config.out;
                    playPhaseTransitionSound('out');
                    if (currentNostril === 'left') {
                        cycles++;
                        elements.cyclesCompleted.textContent = cycles;
                    }
                }
            } else if (currentPhase === 'hold') {
                currentPhase = 'out';
                currentNostril = currentNostril === 'left' ? 'right' : 'left';
                timeLeft = config.out;
                playPhaseTransitionSound('out');
                if (currentNostril === 'left') {
                    cycles++;
                    elements.cyclesCompleted.textContent = cycles;
                }
            }
            updateBreathVisualization(currentPhase, currentNostril, timeLeft, config[currentPhase]);
            updateBreathBarAccessibility(currentPhase, timeLeft, config[currentPhase]);
        }

        // Function to format time in MM:SS or HH:MM:SS
        function formatTime(seconds, includeHours = false) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            const mStr = m.toString().padStart(2, '0');
            const sStr = s.toString().padStart(2, '0');
            return includeHours ? `${h.toString().padStart(2, '0')}:${mStr}:${sStr}` : `${mStr}:${sStr}`;
        }

        // Event listener for the start button
        elements.startBtn.addEventListener('click', () => {
            if (currentPhase === 'ready' || isPaused) {
                const selectedLevel = elements.levelSelect.value;
                let config = levelConfigs[selectedLevel];
                if (selectedLevel === 'custom') {
                    config = customConfig;
                }
                if (currentPhase === 'ready') {
                    currentPhase = 'out';
                    timeLeft = config.out;
                    currentNostril = 'left';
                }
                isPaused = false;
                timer = setInterval(updateTimer, 1000);
                elements.startBtn.disabled = true;
                elements.pauseBtn.disabled = false;
                elements.resetBtn.disabled = false;
                resumeAnimation(elements.leftNostril);
                resumeAnimation(elements.rightNostril);
                resumeAnimation(elements.breathFill);
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }
            }
        });

        // Event listener for the pause button
        elements.pauseBtn.addEventListener('click', () => {
            clearInterval(timer);
            isPaused = true;
            elements.startBtn.disabled = false;
            elements.startBtn.textContent = 'Resume';
            pauseAnimation(elements.leftNostril);
            pauseAnimation(elements.rightNostril);
            pauseAnimation(elements.breathFill);
        });

        // Event listener for the reset button
        elements.resetBtn.addEventListener('click', () => {
            clearInterval(timer);
            resetPractice();
        });

        // Function to reset the practice state
        function resetPractice() {
            currentPhase = 'ready';
            timeLeft = 0;
            totalSeconds = 0;
            cycles = 0;
            currentNostril = 'left';
            isPaused = false;
            elements.startBtn.disabled = false;
            elements.startBtn.textContent = 'Start';
            elements.pauseBtn.disabled = true;
            elements.resetBtn.disabled = true;
            elements.timer.textContent = '00:00';
            elements.totalTime.textContent = '00:00:00';
            elements.cyclesCompleted.textContent = '0';
            updateBreathVisualization('ready', currentNostril, 0, 0);
            updateBreathBarAccessibility('ready', 0, 0);
        }

        // Event listener for level selection changes
        elements.levelSelect.addEventListener('change', () => {
            if (elements.levelSelect.value === 'custom') {
                elements.customIn.value = customConfig.in || '';
                elements.customOut.value = customConfig.out || '';
                elements.customHold.value = customConfig.hold || 0;
                elements.customModal.style.display = "block";
            } else {
                resetPractice();
            }
        });

        // Modal elements and event listeners
        const modalCloseButton = document.querySelector("#customModal .close-button");
        const modalCancelButton = document.querySelector('#customModal .cancel');
        const modalSaveButton = document.querySelector('#customModal .save');
        const modalContent = document.querySelector('.modal-content');

        modalCloseButton.addEventListener('click', closeModal);
        modalCancelButton.addEventListener('click', closeModal);
        window.addEventListener('click', (event) => {
            if (event.target === elements.customModal) {
                closeModal();
            }
        });

        function closeModal() {
            elements.customModal.style.display = "none";
            if (elements.levelSelect.value === 'custom') {
                elements.levelSelect.value = '1';
            }
        }

        modalSaveButton.addEventListener('click', function() {
            const inhale = parseInt(elements.customIn.value, 10);
            const exhale = parseInt(elements.customOut.value, 10);
            const hold = parseInt(elements.customHold.value, 10);

            const existingErrorMessage = modalContent.querySelector('.error-message');
            if (existingErrorMessage) {
                modalContent.removeChild(existingErrorMessage);
            }

            if (inhale > 0 && exhale > 0) {
                customConfig = { in: inhale, out: exhale, hold: hold };
                const selectedOption = elements.levelSelect.options[elements.levelSelect.selectedIndex];
                selectedOption.textContent = `Custom (In: ${inhale}s, Out: ${exhale}s, Hold: ${hold}s)`;
                elements.customModal.style.display = "none";
            } else {
                const errorMessage = document.createElement('p');
                errorMessage.textContent = "Inhale and Exhale times must be greater than 0.";
                errorMessage.style.color = 'red';
                errorMessage.classList.add('error-message');
                modalContent.insertBefore(errorMessage, modalSaveButton);

                elements.customIn.addEventListener('input', () => {
                    if (modalContent.contains(errorMessage)) errorMessage.remove();
                });
                elements.customOut.addEventListener('input', () => {
                    if (modalContent.contains(errorMessage)) errorMessage.remove();
                });
            }
        });

        // Sound controls event listeners
        elements.soundBtn.addEventListener('click', () => {
            soundEnabled = !soundEnabled;
            const icon = elements.soundBtn.querySelector('i');
            icon.className = soundEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
        });

        elements.volumeSlider.addEventListener('input', () => {
            globalVolume = parseFloat(elements.volumeSlider.value);
        });

        // Collapsible sections functionality
        const collapsibleHeaders = document.querySelectorAll('.collapsible-header');
        collapsibleHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const icon = header.querySelector('.toggle-icon');
                content.classList.toggle('collapsed');
                icon.classList.toggle('open');
            });
        });

        // Customization panel functionality
        elements.customizeBtn.addEventListener('click', () => {
            elements.customizationPanel.style.display = (elements.customizationPanel.style.display === 'block' ? 'none' : 'block');
        });

        // Function to apply customizations
        function applyCustomizations() {
            const leftNostrilColor = document.getElementById('leftNostrilColor').value;
            const rightNostrilColor = document.getElementById('rightNostrilColor').value;
            const breathFillColor = document.getElementById('breathBarFillColor').value;
            const breathHoldColor = document.getElementById('breathBarHoldColor').value;

            document.documentElement.style.setProperty('--ida-blue', leftNostrilColor);
            document.documentElement.style.setProperty('--pingala-red', rightNostrilColor);
            document.documentElement.style.setProperty('--sushumna-yellow', breathFillColor);
            document.documentElement.style.setProperty('--sushumna-green', breathHoldColor);

            localStorage.setItem('customColors', JSON.stringify({
                leftNostril: leftNostrilColor,
                rightNostril: rightNostrilColor,
                breathFill: breathFillColor,
                breathHold: breathHoldColor
            }));

            // Update hex color inputs
            document.getElementById('leftNostrilHex').value = leftNostrilColor;
            document.getElementById('rightNostrilHex').value = rightNostrilColor;
            document.getElementById('breathBarFillHex').value = breathFillColor;
            document.getElementById('breathBarHoldHex').value = breathHoldColor;
        }

        // Function to load customizations from local storage
        function loadCustomizations() {
            const savedColors = JSON.parse(localStorage.getItem('customColors'));
            isDarkMode = JSON.parse(localStorage.getItem('darkMode')) ?? true;

            if (savedColors) {
                document.getElementById('leftNostrilColor').value = savedColors.leftNostril;
                document.getElementById('rightNostrilColor').value = savedColors.rightNostril;
                document.getElementById('breathBarFillColor').value = savedColors.breathFill;
                document.getElementById('breathBarHoldColor').value = savedColors.breathHold;
                document.documentElement.style.setProperty('--ida-blue', savedColors.leftNostril);
                document.documentElement.style.setProperty('--pingala-red', savedColors.rightNostril);
                document.documentElement.style.setProperty('--sushumna-yellow', savedColors.breathFill);
                document.documentElement.style.setProperty('--sushumna-green', savedColors.breathHold);
                document.getElementById('leftNostrilHex').value = savedColors.leftNostril;
                document.getElementById('rightNostrilHex').value = savedColors.rightNostril;
                document.getElementById('breathBarFillHex').value = savedColors.breathFill;
                document.getElementById('breathBarHoldHex').value = savedColors.breathHold;
            }

            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                elements.darkModeToggle.textContent = 'Light Mode';
            } else {
                document.body.classList.remove('dark-mode');
                elements.darkModeToggle.textContent = 'Dark Mode';
            }
        }

        // Event listeners for color inputs
        document.getElementById('leftNostrilColor').addEventListener('input', () => {
            document.getElementById('leftNostrilHex').value = document.getElementById('leftNostrilColor').value;
            applyCustomizations();
        });
        document.getElementById('rightNostrilColor').addEventListener('input', () => {
            document.getElementById('rightNostrilHex').value = document.getElementById('rightNostrilColor').value;
            applyCustomizations();
        });
        document.getElementById('breathBarFillColor').addEventListener('input', () => {
            document.getElementById('breathBarFillHex').value = document.getElementById('breathBarFillColor').value;
            applyCustomizations();
        });
        document.getElementById('breathBarHoldColor').addEventListener('input', () => {
            document.getElementById('breathBarHoldHex').value = document.getElementById('breathBarHoldColor').value;
            applyCustomizations();
        });

        // Event listeners for hex color inputs
        document.getElementById('leftNostrilHex').addEventListener('input', () => {
            document.getElementById('leftNostrilColor').value = document.getElementById('leftNostrilHex').value;
            applyCustomizations();
        });
        document.getElementById('rightNostrilHex').addEventListener('input', () => {
            document.getElementById('rightNostrilColor').value = document.getElementById('rightNostrilHex').value;
            applyCustomizations();
        });
        document.getElementById('breathBarFillHex').addEventListener('input', () => {
            document.getElementById('breathBarFillColor').value = document.getElementById('breathBarFillHex').value;
            applyCustomizations();
        });
        document.getElementById('breathBarHoldHex').addEventListener('input', () => {
            document.getElementById('breathBarHoldHex').value = document.getElementById('breathBarHoldHex').value;
            applyCustomizations();
        });

        // Save changes button functionality
        document.getElementById('saveChanges').addEventListener('click', () => {
            applyCustomizations();
            elements.customizationPanel.style.display = 'none';
        });

        // Reset to default button functionality
        document.getElementById('resetChanges').addEventListener('click', () => {
            localStorage.removeItem('customColors');
            localStorage.removeItem('darkMode');
            resetCustomizationColors();
            applyCustomizations();
            setDarkMode(true); // Ensure dark mode is enabled after reset
        });

        function resetCustomizationColors() {
            const defaultColors = {
                leftNostril: "#004dab",
                rightNostril: "#ff2a00",
                breathFill: "#fee74d",
                breathHold: "#00a550"
            };
            document.getElementById('leftNostrilColor').value = defaultColors.leftNostril;
            document.getElementById('rightNostrilColor').value = defaultColors.rightNostril;
            document.getElementById('breathBarFillColor').value = defaultColors.breathFill;
            document.getElementById('breathBarHoldColor').value = defaultColors.breathHold;
            document.getElementById('leftNostrilHex').value = defaultColors.leftNostril;
            document.getElementById('rightNostrilHex').value = defaultColors.rightNostril;
            document.getElementById('breathBarFillHex').value = defaultColors.breathFill;
            document.getElementById('breathBarHoldHex').value = defaultColors.breathHold;
            applyCustomizations();
        }

        // Dark/light mode toggle functionality
        elements.darkModeToggle.addEventListener('click', () => {
            setDarkMode(!isDarkMode);
        });

        function setDarkMode(darkMode) {
            isDarkMode = darkMode;
            document.body.classList.toggle('light-mode', !darkMode);
            document.body.classList.toggle('dark-mode', darkMode);
            elements.darkModeToggle.textContent = darkMode ? 'Light Mode' : 'Dark Mode';
            localStorage.setItem('darkMode', darkMode);
        }

        // Fullscreen functionality
        elements.fullscreenBtn.addEventListener('click', toggleFullscreen);

        function toggleFullscreen() {
            document.body.classList.toggle('fullscreen-mode');
            isFullscreen = !isFullscreen;
            elements.fullscreenBtn.textContent = isFullscreen ? 'Go Back' : 'Expand View';
        }

        // Close customization panel when clicking outside
        document.addEventListener('click', (event) => {
            if (elements.customizationPanel.style.display === 'block' && !event.target.closest('#customizationPanel') && event.target !== elements.customizeBtn) {
                elements.customizationPanel.style.display = 'none';
            }
        });

        // Initialize settings on page load
        window.onload = () => {
            elements.volumeSlider.value = globalVolume;
            loadCustomizations();
        };
    </script>
</body>
</html>